

get_filename_component(cuda_path_absolute ${CUDNN_PATH} ABSOLUTE)

message(STATUS "Looking for cuDNN install...")

set(CUDNN_INCLUDE_DIR ${cuda_path_absolute}/include)
set(CUDNN_LIBRARY_DIR ${cuda_path_absolute}/lib)

message (STATUS "CUDNN_INCLUDE_DIR=${CUDNN_INCLUDE_DIR}")
message (STATUS "CUDNN_LIBRARY_DIR=${CUDNN_LIBRARY_DIR}")

# Look for cudnn, we will look in the same place as other CUDA
# libraries and also a few other places as well.
find_path(cudnn_include cudnn.h
    HINTS ${CUDA_INCLUDE_DIRS} 
    PATHS /usr/local/include ${CUDNN_INCLUDE_DIR} 
    )

message (STATUS "CUDNN_PATH=${CUDNN_PATH}")
message (STATUS "cudnn_include=${cudnn_include}")

get_filename_component(cudnn_hint_path ${CUDA_CUBLAS_LIBRARIES} PATH)
find_library(cudnn cudnn
    HINTS ${cudnn_hint_path} 
    PATHS /usr/local/lib64 
            /usr/local/cuda/lib64
            /usr/local/cuda/lib
            /usr/local/lib
            ${CUDNN_LIBRARY_DIR}
    )
    
    message (STATUS "cudnn=${cudnn}")
    
mark_as_advanced(cudnn cudnn_include)
